
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../../FluxCD/FluxCD_demonstration_par_l_exemple/">
      
      
        <link rel="next" href="../cluster_GKE_Wordpress_CloudSQL/">
      
      
      <link rel="icon" href="../../images/poo.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.21">
    
    
      
        <title>Cluster GKE en mode autopilot, load-balancer HTTPS et application 'stateless' - Papa Francky's HowTos</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.2a3383ac.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      
  
  
    
      
      
    
  
    
      
      
    
  
    
      
      
    
  
    
      
      
    
  
    
      
      
    
  
    
      
      
    
  
    
      
      
    
  
    
      
      
    
  
    
      
      
    
  
    
      
      
    
  
    
      
      
    
  
    
      
      
    
  
  
  <style>:root{--md-admonition-icon--note:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M1%207.775V2.75C1%201.784%201.784%201%202.75%201h5.025c.464%200%20.91.184%201.238.513l6.25%206.25a1.75%201.75%200%200%201%200%202.474l-5.026%205.026a1.75%201.75%200%200%201-2.474%200l-6.25-6.25A1.75%201.75%200%200%201%201%207.775m1.5%200c0%20.066.026.13.073.177l6.25%206.25a.25.25%200%200%200%20.354%200l5.025-5.025a.25.25%200%200%200%200-.354l-6.25-6.25a.25.25%200%200%200-.177-.073H2.75a.25.25%200%200%200-.25.25ZM6%205a1%201%200%201%201%200%202%201%201%200%200%201%200-2%22/%3E%3C/svg%3E');--md-admonition-icon--abstract:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M2.5%201.75v11.5c0%20.138.112.25.25.25h3.17a.75.75%200%200%201%200%201.5H2.75A1.75%201.75%200%200%201%201%2013.25V1.75C1%20.784%201.784%200%202.75%200h8.5C12.216%200%2013%20.784%2013%201.75v7.736a.75.75%200%200%201-1.5%200V1.75a.25.25%200%200%200-.25-.25h-8.5a.25.25%200%200%200-.25.25m13.274%209.537zl-4.557%204.45a.75.75%200%200%201-1.055-.008l-1.943-1.95a.75.75%200%200%201%201.062-1.058l1.419%201.425%204.026-3.932a.75.75%200%201%201%201.048%201.074M4.75%204h4.5a.75.75%200%200%201%200%201.5h-4.5a.75.75%200%200%201%200-1.5M4%207.75A.75.75%200%200%201%204.75%207h2a.75.75%200%200%201%200%201.5h-2A.75.75%200%200%201%204%207.75%22/%3E%3C/svg%3E');--md-admonition-icon--info:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M0%208a8%208%200%201%201%2016%200A8%208%200%200%201%200%208m8-6.5a6.5%206.5%200%201%200%200%2013%206.5%206.5%200%200%200%200-13M6.5%207.75A.75.75%200%200%201%207.25%207h1a.75.75%200%200%201%20.75.75v2.75h.25a.75.75%200%200%201%200%201.5h-2a.75.75%200%200%201%200-1.5h.25v-2h-.25a.75.75%200%200%201-.75-.75M8%206a1%201%200%201%201%200-2%201%201%200%200%201%200%202%22/%3E%3C/svg%3E');--md-admonition-icon--tip:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M3.499.75a.75.75%200%200%201%201.5%200v.996C5.9%202.903%206.793%203.65%207.662%204.376l.24.202c-.036-.694.055-1.422.426-2.163C9.1.873%2010.794-.045%2012.622.26%2014.408.558%2016%201.94%2016%204.25c0%201.278-.954%202.575-2.44%202.734l.146.508.065.22c.203.701.412%201.455.476%202.226.142%201.707-.4%203.03-1.487%203.898C11.714%2014.671%2010.27%2015%208.75%2015h-6a.75.75%200%200%201%200-1.5h1.376a4.5%204.5%200%200%201-.563-1.191%203.84%203.84%200%200%201-.05-2.063%204.65%204.65%200%200%201-2.025-.293.75.75%200%200%201%20.525-1.406c1.357.507%202.376-.006%202.698-.318l.009-.01a.747.747%200%200%201%201.06%200%20.75.75%200%200%201-.012%201.074c-.912.92-.992%201.835-.768%202.586.221.74.745%201.337%201.196%201.621H8.75c1.343%200%202.398-.296%203.074-.836.635-.507%201.036-1.31.928-2.602-.05-.603-.216-1.224-.422-1.93l-.064-.221c-.12-.407-.246-.84-.353-1.29a2.4%202.4%200%200%201-.507-.441%203.1%203.1%200%200%201-.633-1.248.75.75%200%200%201%201.455-.364c.046.185.144.436.31.627.146.168.353.305.712.305.738%200%201.25-.615%201.25-1.25%200-1.47-.95-2.315-2.123-2.51-1.172-.196-2.227.387-2.706%201.345-.46.92-.27%201.774.019%203.062l.042.19.01.05c.348.443.666.949.94%201.553a.75.75%200%201%201-1.365.62c-.553-1.217-1.32-1.94-2.3-2.768L6.7%205.527c-.814-.68-1.75-1.462-2.692-2.619a3.7%203.7%200%200%200-1.023.88c-.406.495-.663%201.036-.722%201.508.116.122.306.21.591.239.388.038.797-.06%201.032-.19a.75.75%200%200%201%20.728%201.31c-.515.287-1.23.439-1.906.373-.682-.067-1.473-.38-1.879-1.193L.75%205.677V5.5c0-.984.48-1.94%201.077-2.664.46-.559%201.05-1.055%201.673-1.353z%22/%3E%3C/svg%3E');--md-admonition-icon--success:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M13.78%204.22a.75.75%200%200%201%200%201.06l-7.25%207.25a.75.75%200%200%201-1.06%200L2.22%209.28a.75.75%200%200%201%20.018-1.042.75.75%200%200%201%201.042-.018L6%2010.94l6.72-6.72a.75.75%200%200%201%201.06%200%22/%3E%3C/svg%3E');--md-admonition-icon--question:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M0%208a8%208%200%201%201%2016%200A8%208%200%200%201%200%208m8-6.5a6.5%206.5%200%201%200%200%2013%206.5%206.5%200%200%200%200-13M6.92%206.085h.001a.749.749%200%201%201-1.342-.67c.169-.339.436-.701.849-.977C6.845%204.16%207.369%204%208%204a2.76%202.76%200%200%201%201.637.525c.503.377.863.965.863%201.725%200%20.448-.115.83-.329%201.15-.205.307-.47.513-.692.662-.109.072-.22.138-.313.195l-.006.004a6%206%200%200%200-.26.16%201%201%200%200%200-.276.245.75.75%200%200%201-1.248-.832c.184-.264.42-.489.692-.661q.154-.1.313-.195l.007-.004c.1-.061.182-.11.258-.161a1%201%200%200%200%20.277-.245C8.96%206.514%209%206.427%209%206.25a.61.61%200%200%200-.262-.525A1.27%201.27%200%200%200%208%205.5c-.369%200-.595.09-.74.187a1%201%200%200%200-.34.398M9%2011a1%201%200%201%201-2%200%201%201%200%200%201%202%200%22/%3E%3C/svg%3E');--md-admonition-icon--warning:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M6.457%201.047c.659-1.234%202.427-1.234%203.086%200l6.082%2011.378A1.75%201.75%200%200%201%2014.082%2015H1.918a1.75%201.75%200%200%201-1.543-2.575Zm1.763.707a.25.25%200%200%200-.44%200L1.698%2013.132a.25.25%200%200%200%20.22.368h12.164a.25.25%200%200%200%20.22-.368Zm.53%203.996v2.5a.75.75%200%200%201-1.5%200v-2.5a.75.75%200%200%201%201.5%200M9%2011a1%201%200%201%201-2%200%201%201%200%200%201%202%200%22/%3E%3C/svg%3E');--md-admonition-icon--failure:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M2.344%202.343za8%208%200%200%201%2011.314%2011.314A8.002%208.002%200%200%201%20.234%2010.089a8%208%200%200%201%202.11-7.746m1.06%2010.253a6.5%206.5%200%201%200%209.108-9.275%206.5%206.5%200%200%200-9.108%209.275M6.03%204.97%208%206.94l1.97-1.97a.749.749%200%200%201%201.275.326.75.75%200%200%201-.215.734L9.06%208l1.97%201.97a.749.749%200%200%201-.326%201.275.75.75%200%200%201-.734-.215L8%209.06l-1.97%201.97a.749.749%200%200%201-1.275-.326.75.75%200%200%201%20.215-.734L6.94%208%204.97%206.03a.75.75%200%200%201%20.018-1.042.75.75%200%200%201%201.042-.018%22/%3E%3C/svg%3E');--md-admonition-icon--danger:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M9.504.43a1.516%201.516%200%200%201%202.437%201.713L10.415%205.5h2.123c1.57%200%202.346%201.909%201.22%203.004l-7.34%207.142a1.25%201.25%200%200%201-.871.354h-.302a1.25%201.25%200%200%201-1.157-1.723L5.633%2010.5H3.462c-1.57%200-2.346-1.909-1.22-3.004zm1.047%201.074L3.286%208.571A.25.25%200%200%200%203.462%209H6.75a.75.75%200%200%201%20.694%201.034l-1.713%204.188%206.982-6.793A.25.25%200%200%200%2012.538%207H9.25a.75.75%200%200%201-.683-1.06l2.008-4.418.003-.006-.004-.009-.006-.006-.008-.001q-.005%200-.009.004%22/%3E%3C/svg%3E');--md-admonition-icon--bug:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M4.72.22a.75.75%200%200%201%201.06%200l1%20.999a3.5%203.5%200%200%201%202.441%200l.999-1a.748.748%200%200%201%201.265.332.75.75%200%200%201-.205.729l-.775.776c.616.63.995%201.493.995%202.444v.327q0%20.15-.025.292c.408.14.764.392%201.029.722l1.968-.787a.75.75%200%200%201%20.556%201.392L13%207.258V9h2.25a.75.75%200%200%201%200%201.5H13v.5q-.002.615-.141%201.186l2.17.868a.75.75%200%200%201-.557%201.392l-2.184-.873A5%205%200%200%201%208%2016a5%205%200%200%201-4.288-2.427l-2.183.873a.75.75%200%200%201-.558-1.392l2.17-.868A5%205%200%200%201%203%2011v-.5H.75a.75.75%200%200%201%200-1.5H3V7.258L.971%206.446a.75.75%200%200%201%20.558-1.392l1.967.787c.265-.33.62-.583%201.03-.722a1.7%201.7%200%200%201-.026-.292V4.5c0-.951.38-1.814.995-2.444L4.72%201.28a.75.75%200%200%201%200-1.06m.53%206.28a.75.75%200%200%200-.75.75V11a3.5%203.5%200%201%200%207%200V7.25a.75.75%200%200%200-.75-.75ZM6.173%205h3.654A.17.17%200%200%200%2010%204.827V4.5a2%202%200%201%200-4%200v.327c0%20.096.077.173.173.173%22/%3E%3C/svg%3E');--md-admonition-icon--example:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5%205.782V2.5h-.25a.75.75%200%200%201%200-1.5h6.5a.75.75%200%200%201%200%201.5H11v3.282l3.666%205.76C15.619%2013.04%2014.543%2015%2012.767%2015H3.233c-1.776%200-2.852-1.96-1.899-3.458Zm-2.4%206.565a.75.75%200%200%200%20.633%201.153h9.534a.75.75%200%200%200%20.633-1.153L12.225%2010.5h-8.45ZM9.5%202.5h-3V6c0%20.143-.04.283-.117.403L4.73%209h6.54L9.617%206.403A.75.75%200%200%201%209.5%206Z%22/%3E%3C/svg%3E');--md-admonition-icon--quote:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M1.75%202.5h10.5a.75.75%200%200%201%200%201.5H1.75a.75.75%200%200%201%200-1.5m4%205h8.5a.75.75%200%200%201%200%201.5h-8.5a.75.75%200%200%201%200-1.5m0%205h8.5a.75.75%200%200%201%200%201.5h-8.5a.75.75%200%200%201%200-1.5M2.5%207.75v6a.75.75%200%200%201-1.5%200v-6a.75.75%200%200%201%201.5%200%22/%3E%3C/svg%3E');}</style>


  
  
  
  
  <style>:root{--md-annotation-icon:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20d%3D%22M17%2013h-4v4h-2v-4H7v-2h4V7h2v4h4m-5-9A10%2010%200%200%200%202%2012a10%2010%200%200%200%2010%2010%2010%2010%200%200%200%2010-10A10%2010%200%200%200%2012%202%22/%3E%3C/svg%3E');}</style>


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="blue-grey" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#cluster-gke-en-mode-autopilot-load-balancer-https-et-application-stateless" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Papa Francky&#39;s HowTos" class="md-header__button md-logo" aria-label="Papa Francky's HowTos" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M268.9.9c-5.5-.7-11 1.4-14.5 5.7s-4.6 10.1-2.8 15.4c2.8 8.2 4.3 16.9 4.3 26.1 0 44.1-35.7 79.9-79.8 80L160 128c-35.3 0-64 28.7-64 64 0 19.1 8.4 36.3 21.7 48H104c-39.8 0-72 32.2-72 72 0 23.2 11 43.8 28 57-34.1 5.7-60 35.3-60 71 0 39.8 32.2 72 72 72h368c39.8 0 72-32.2 72-72 0-35.7-25.9-65.3-60-71 17-13.2 28-33.8 28-57 0-39.8-32.2-72-72-72h-13.7c13.3-11.7 21.7-28.9 21.7-48 0-35.3-28.7-64-64-64h-5.5c3.5-10 5.5-20.8 5.5-32 0-48.6-36.2-88.8-83.1-95.1M192 256a32 32 0 1 1 0 64 32 32 0 1 1 0-64m96 32a32 32 0 1 1 64 0 32 32 0 1 1-64 0m64 108.3c0 2.4-.7 4.8-2.2 6.7-8.2 10.5-39.5 45-93.8 45s-85.6-34.6-93.8-45c-1.5-1.9-2.2-4.3-2.2-6.7 0-6.8 5.5-12.3 12.3-12.3h167.4c6.8 0 12.3 5.5 12.3 12.3"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Papa Francky's HowTos
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Cluster GKE en mode autopilot, load-balancer HTTPS et application 'stateless'
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="blue-grey" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="orange" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Papa Francky&#39;s HowTos" class="md-nav__button md-logo" aria-label="Papa Francky's HowTos" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M268.9.9c-5.5-.7-11 1.4-14.5 5.7s-4.6 10.1-2.8 15.4c2.8 8.2 4.3 16.9 4.3 26.1 0 44.1-35.7 79.9-79.8 80L160 128c-35.3 0-64 28.7-64 64 0 19.1 8.4 36.3 21.7 48H104c-39.8 0-72 32.2-72 72 0 23.2 11 43.8 28 57-34.1 5.7-60 35.3-60 71 0 39.8 32.2 72 72 72h368c39.8 0 72-32.2 72-72 0-35.7-25.9-65.3-60-71 17-13.2 28-33.8 28-57 0-39.8-32.2-72-72-72h-13.7c13.3-11.7 21.7-28.9 21.7-48 0-35.3-28.7-64-64-64h-5.5c3.5-10 5.5-20.8 5.5-32 0-48.6-36.2-88.8-83.1-95.1M192 256a32 32 0 1 1 0 64 32 32 0 1 1 0-64m96 32a32 32 0 1 1 64 0 32 32 0 1 1-64 0m64 108.3c0 2.4-.7 4.8-2.2 6.7-8.2 10.5-39.5 45-93.8 45s-85.6-34.6-93.8-45c-1.5-1.9-2.2-4.3-2.2-6.7 0-6.8 5.5-12.3 12.3-12.3h167.4c6.8 0 12.3 5.5 12.3 12.3"/></svg>

    </a>
    Papa Francky's HowTos
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MkDocs cheatsheet
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    000 setup
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            000 setup
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../000_setup/Command_line_tools/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Command Line Tools
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../000_setup/Kubernetes_en_local/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Kubernetes en local
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Docker
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Docker
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Docker/build_pull_image_on_dockerhub/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Créer et publier une image sur DockerHub
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    FluxCD
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            FluxCD
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../FluxCD/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Index
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../FluxCD/FlucCD_arborescence_par_produit/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    FluxCD - Proposition de nouvelle organisation des manifests
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../FluxCD/FluxCD_demonstration_par_l_exemple/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    FluxCD - Démonstration par l'exemple
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    GKE
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            GKE
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1" checked>
        
          
          <label class="md-nav__link" for="__nav_5_1" id="__nav_5_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    cluster GKE SSL load balancer
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5_1">
            <span class="md-nav__icon md-icon"></span>
            cluster GKE SSL load balancer
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Cluster GKE en mode autopilot, load-balancer HTTPS et application 'stateless'
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Cluster GKE en mode autopilot, load-balancer HTTPS et application 'stateless'
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#pre-requis" class="md-nav__link">
    <span class="md-ellipsis">
      Pré-requis
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#variables" class="md-nav__link">
    <span class="md-ellipsis">
      Variables
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configurer-votre-environnement" class="md-nav__link">
    <span class="md-ellipsis">
      Configurer votre environnement
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#activer-les-api-google-kubernetes-engine-cloud-dns" class="md-nav__link">
    <span class="md-ellipsis">
      Activer les API Google Kubernetes Engine, Cloud DNS.
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recuperation-du-code-depuis-github" class="md-nav__link">
    <span class="md-ellipsis">
      Récupération du code depuis GitHub
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deploiement-du-cluster-gke" class="md-nav__link">
    <span class="md-ellipsis">
      Déploiement du cluster GKE
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#verification-du-deploiement" class="md-nav__link">
    <span class="md-ellipsis">
      Vérification du déploiement
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Vérification du déploiement">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dns" class="md-nav__link">
    <span class="md-ellipsis">
      DNS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cluster-kubernetes" class="md-nav__link">
    <span class="md-ellipsis">
      Cluster Kubernetes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ip-statique-publique" class="md-nav__link">
    <span class="md-ellipsis">
      IP statique publique
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modification-des-name-servers-ns-du-domaine-dns-aupres-du-registrar" class="md-nav__link">
    <span class="md-ellipsis">
      Modification des 'Name Servers (NS) du domaine DNS auprès du 'registrar'
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deploiement-du-load-balancer-applicatif-externe" class="md-nav__link">
    <span class="md-ellipsis">
      Déploiement du Load-Balancer applicatif externe
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Déploiement du Load-Balancer applicatif externe">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration-de-kubectl-pour-se-connecter-au-cluster-recemment-cree" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration de kubectl pour se connecter au cluster récemment créé
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configuration de kubectl pour se connecter au cluster récemment créé">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#verifier-que-nous-utilisons-le-bon-contexte-kubernetes" class="md-nav__link">
    <span class="md-ellipsis">
      Vérifier que nous utilisons le bon contexte kubernetes :
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verifier-que-nous-pouvons-bien-nous-connecter-au-cluster" class="md-nav__link">
    <span class="md-ellipsis">
      Vérifier que nous pouvons bien nous connecter au cluster
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creation-du-certificat-ssl-du-load-balancer-de-lingress" class="md-nav__link">
    <span class="md-ellipsis">
      Création du certificat SSL, du load-balancer, de l'ingress
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Création du certificat SSL, du load-balancer, de l&#39;ingress">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#verification-de-la-creation-de-lingress" class="md-nav__link">
    <span class="md-ellipsis">
      Vérification de la création de l'ingress
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verification-du-provisioning-du-certificat-tls-peut-prendre-30-minutes" class="md-nav__link">
    <span class="md-ellipsis">
      Vérification du provisioning du certificat TLS (peut prendre 30 minutes)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Vérification du provisioning du certificat TLS (peut prendre 30 minutes)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#avec-kubectl" class="md-nav__link">
    <span class="md-ellipsis">
      avec kubectl
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#via-la-console-security-certificate-manager" class="md-nav__link">
    <span class="md-ellipsis">
      via la console : Security / Certificate Manager
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#documentation-de-troubleshooting-google-managed-ssl-certificates" class="md-nav__link">
    <span class="md-ellipsis">
      Documentation de troubleshooting Google-managed SSL certificates :
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verification-de-ladresse-ip-publique-reservee" class="md-nav__link">
    <span class="md-ellipsis">
      Vérification de l'adresse IP publique réservée
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verification-de-lingress" class="md-nav__link">
    <span class="md-ellipsis">
      Vérification de l'Ingress
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#test-application" class="md-nav__link">
    <span class="md-ellipsis">
      Test application
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nettoyage" class="md-nav__link">
    <span class="md-ellipsis">
      Nettoyage
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#divers" class="md-nav__link">
    <span class="md-ellipsis">
      Divers
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#next-step" class="md-nav__link">
    <span class="md-ellipsis">
      Next step
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    cluster GKE Wordpress CloudSQL
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            cluster GKE Wordpress CloudSQL
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cluster_GKE_Wordpress_CloudSQL/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Deploy WordPress on GKE with Persistent Disk and Cloud SQL
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_3" >
        
          
          <label class="md-nav__link" for="__nav_5_3" id="__nav_5_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Dkt upgrade cluster gke
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_3">
            <span class="md-nav__icon md-icon"></span>
            Dkt upgrade cluster gke
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dkt_upgrade_cluster_gke/readme/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Mise à jour des clusters Kubernetes
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_4" >
        
          
          <label class="md-nav__link" for="__nav_5_4" id="__nav_5_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    terraform GKE cluster
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_4">
            <span class="md-nav__icon md-icon"></span>
            terraform GKE cluster
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../terraform_GKE_cluster/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Index
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Minikube
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Minikube
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Minikube/minikube_nginx_controller_macos/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Minikube et l'ingress Nginx sur macOS
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_2" >
        
          
          <label class="md-nav__link" for="__nav_6_2" id="__nav_6_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Prometheus on minikube from scratch
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_2">
            <span class="md-nav__icon md-icon"></span>
            Prometheus on minikube from scratch
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Minikube/prometheus_on_minikube_from_scratch/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Prometheus on MiniKube from scratch
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Prometheus and Grafana
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Prometheus and Grafana
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Prometheus_and_Grafana/kube-prometheus-stack_managed_with_fluxcd/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    'kube-prometheus-stack' managed with FluxCD
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Prometheus_and_Grafana/prometheus_grafana_on_k8s/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Prometheus &amp; Grafana on Kubernetes
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Vault
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Vault
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_1" >
        
          
          <label class="md-nav__link" for="__nav_8_1" id="__nav_8_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Cluster minikube vault with raft storage
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_1">
            <span class="md-nav__icon md-icon"></span>
            Cluster minikube vault with raft storage
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Vault/cluster_minikube_vault_with_raft_storage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cluster [kind|minikube] - HashiCorp Vault with Raft integrated storage
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2" >
        
          
          <label class="md-nav__link" for="__nav_8_2" id="__nav_8_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Helm vault auto unseal
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_2">
            <span class="md-nav__icon md-icon"></span>
            Helm vault auto unseal
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Vault/helm_vault_auto-unseal/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Auto-unsealed Vault Helm deployment managed with FluxCD
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_3" >
        
          
          <label class="md-nav__link" for="__nav_8_3" id="__nav_8_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    kind helm vault auto unseal ESO
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_3">
            <span class="md-nav__icon md-icon"></span>
            kind helm vault auto unseal ESO
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Vault/kind_helm_vault_auto-unseal_ESO/kind_vault_auto-unsealed_eso_fluxcd/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Déploiement de Vault (auto-unsealed) et ESO via FluxCD sur un cluster KinD
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_4" >
        
          
          <label class="md-nav__link" for="__nav_8_4" id="__nav_8_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Kind vault external secrets operator
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_4">
            <span class="md-nav__icon md-icon"></span>
            Kind vault external secrets operator
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Vault/kind_vault_external_secrets_operator/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Kind - Vault - External-secrets operator
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Vault/kind_vault_external_secrets_operator/README.2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Kind - Vault - External-secrets operator
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_5" >
        
          
          <label class="md-nav__link" for="__nav_8_5" id="__nav_8_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    protect secrets using Vault and External Secrets Operator
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_5">
            <span class="md-nav__icon md-icon"></span>
            protect secrets using Vault and External Secrets Operator
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Vault/protect_secrets_using_Vault_and_External_Secrets_Operator/readme/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Protect the secrets of your application using HashiCorp Vault and the External Secrets Operator (ESO)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#pre-requis" class="md-nav__link">
    <span class="md-ellipsis">
      Pré-requis
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#variables" class="md-nav__link">
    <span class="md-ellipsis">
      Variables
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configurer-votre-environnement" class="md-nav__link">
    <span class="md-ellipsis">
      Configurer votre environnement
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#activer-les-api-google-kubernetes-engine-cloud-dns" class="md-nav__link">
    <span class="md-ellipsis">
      Activer les API Google Kubernetes Engine, Cloud DNS.
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recuperation-du-code-depuis-github" class="md-nav__link">
    <span class="md-ellipsis">
      Récupération du code depuis GitHub
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deploiement-du-cluster-gke" class="md-nav__link">
    <span class="md-ellipsis">
      Déploiement du cluster GKE
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#verification-du-deploiement" class="md-nav__link">
    <span class="md-ellipsis">
      Vérification du déploiement
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Vérification du déploiement">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dns" class="md-nav__link">
    <span class="md-ellipsis">
      DNS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cluster-kubernetes" class="md-nav__link">
    <span class="md-ellipsis">
      Cluster Kubernetes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ip-statique-publique" class="md-nav__link">
    <span class="md-ellipsis">
      IP statique publique
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modification-des-name-servers-ns-du-domaine-dns-aupres-du-registrar" class="md-nav__link">
    <span class="md-ellipsis">
      Modification des 'Name Servers (NS) du domaine DNS auprès du 'registrar'
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deploiement-du-load-balancer-applicatif-externe" class="md-nav__link">
    <span class="md-ellipsis">
      Déploiement du Load-Balancer applicatif externe
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Déploiement du Load-Balancer applicatif externe">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration-de-kubectl-pour-se-connecter-au-cluster-recemment-cree" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration de kubectl pour se connecter au cluster récemment créé
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configuration de kubectl pour se connecter au cluster récemment créé">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#verifier-que-nous-utilisons-le-bon-contexte-kubernetes" class="md-nav__link">
    <span class="md-ellipsis">
      Vérifier que nous utilisons le bon contexte kubernetes :
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verifier-que-nous-pouvons-bien-nous-connecter-au-cluster" class="md-nav__link">
    <span class="md-ellipsis">
      Vérifier que nous pouvons bien nous connecter au cluster
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creation-du-certificat-ssl-du-load-balancer-de-lingress" class="md-nav__link">
    <span class="md-ellipsis">
      Création du certificat SSL, du load-balancer, de l'ingress
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Création du certificat SSL, du load-balancer, de l&#39;ingress">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#verification-de-la-creation-de-lingress" class="md-nav__link">
    <span class="md-ellipsis">
      Vérification de la création de l'ingress
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verification-du-provisioning-du-certificat-tls-peut-prendre-30-minutes" class="md-nav__link">
    <span class="md-ellipsis">
      Vérification du provisioning du certificat TLS (peut prendre 30 minutes)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Vérification du provisioning du certificat TLS (peut prendre 30 minutes)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#avec-kubectl" class="md-nav__link">
    <span class="md-ellipsis">
      avec kubectl
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#via-la-console-security-certificate-manager" class="md-nav__link">
    <span class="md-ellipsis">
      via la console : Security / Certificate Manager
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#documentation-de-troubleshooting-google-managed-ssl-certificates" class="md-nav__link">
    <span class="md-ellipsis">
      Documentation de troubleshooting Google-managed SSL certificates :
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verification-de-ladresse-ip-publique-reservee" class="md-nav__link">
    <span class="md-ellipsis">
      Vérification de l'adresse IP publique réservée
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verification-de-lingress" class="md-nav__link">
    <span class="md-ellipsis">
      Vérification de l'Ingress
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#test-application" class="md-nav__link">
    <span class="md-ellipsis">
      Test application
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nettoyage" class="md-nav__link">
    <span class="md-ellipsis">
      Nettoyage
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#divers" class="md-nav__link">
    <span class="md-ellipsis">
      Divers
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#next-step" class="md-nav__link">
    <span class="md-ellipsis">
      Next step
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="cluster-gke-en-mode-autopilot-load-balancer-https-et-application-stateless">Cluster GKE en mode autopilot, load-balancer HTTPS et application 'stateless'</h1>
<p>Pour me former à Google Kubernetes Engine (GKE), j'ai suivi le tutoriel suivant mais avec beaucoup de difficulté car il comporte des erreurs. Sur la base du tutoriel de Google, j'ai documenté la manière dont je m'y suis pris pour arriver à déployer un cluster GKE avec un load-balancer exposé à internet permettant d'accéder en HTTPS à une petite application 'stateless'.</p>
<div class="language-text highlight"><pre><span></span><code>  # Tutoriel Google : Configurer la mise en réseau pour un cluster de production de base
  https://cloud.google.com/kubernetes-engine/docs/tutorials/configure-networking?hl=en.
</code></pre></div>
<h2 id="pre-requis">Pré-requis</h2>
<ul>
<li>Disposer d'un compte Google et accéder à la console GCP ( https://console.cloud.console.com )</li>
<li>Avoir créé un projet (renseigner son ID dans la variable ${PROJECT_ID} ci-après)</li>
<li>Lancer CloudShell (les commandes qui suivent seront exécutées dans CloudShell)</li>
</ul>
<h2 id="variables">Variables</h2>
<ul>
<li>Se connecter à la console GCP</li>
<li>
<p>Sélectionner le projet souhaité et dont l'ID est renseigné dans la variable ${PROJECT_ID} ci-dessous.</p>
<p>PROJECT_ID="project-230902"                   # ID du projet GCP
  REGION="europe-west4"                         # Netherlands
  CLUSTER_NAME="sandbox-cluster"                # nom du cluster
  RESERVED_DOMAIN_NAME="vanille-fraise.net"     # Nom de domaine réservé auprès d'un 'registrar'
  APPLICATION_NAME="hello"                      # Nom de l'application</p>
</li>
</ul>
<h2 id="configurer-votre-environnement">Configurer votre environnement</h2>
<div class="language-text highlight"><pre><span></span><code>  rm -rf ~/.kube                                    # nettoyage
  rm -rf .terraform* terraform.tfstate              # nettoyage

  # configuration de kubectl
  gcloud config set project ${PROJECT_ID}
  gcloud services enable compute.googleapis.com     # nécessaire pour définir la région (la commande prend du temps)
  gcloud config set compute/region ${REGION}

  gcloud config list
</code></pre></div>
<h2 id="activer-les-api-google-kubernetes-engine-cloud-dns">Activer les API Google Kubernetes Engine, Cloud DNS.</h2>
<div class="language-text highlight"><pre><span></span><code>  gcloud services enable container.googleapis.com
  gcloud services enable dns.googleapis.com
  gcloud services list --enabled --project ${PROJECT_ID}
</code></pre></div>
<h2 id="recuperation-du-code-depuis-github">Récupération du code depuis GitHub</h2>
<div class="language-text highlight"><pre><span></span><code>  git clone https://github.com/papaFrancky/cluster_GKE_SSL_load-balancer
  cd cluster_GKE_SSL_load-balancer
</code></pre></div>
<p>( Via la WUI GitHub : https://github.com/papaFrancky/cluster_GKE_SSL_load-balancer.git )</p>
<h2 id="deploiement-du-cluster-gke">Déploiement du cluster GKE</h2>
<p>( doc. utile :  HashiCorp - provider Google https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster)</p>
<p>Nous allons surcharger la valeur par défaut de certaines variables en écrivant un fichier '.auto.tfvars' :</p>
<div class="language-text highlight"><pre><span></span><code>  cat &lt;&lt; EOF &gt; cluster.auto.tfvars
  region               = &quot;${REGION}&quot;
  reserved_domain_name = &quot;${RESERVED_DOMAIN_NAME}&quot;
  cluster_name         = &quot;${CLUSTER_NAME}&quot;
  application_name     = &quot;${APPLICATION_NAME}&quot;
  EOF
</code></pre></div>
<p>Nous pouvons ensuite exécuter le code Terraform :</p>
<div class="language-text highlight"><pre><span></span><code>  terraform init
  terraform plan
  terraform apply --auto-approve
</code></pre></div>
<p>Exemple de sortie : </p>
<div class="language-text highlight"><pre><span></span><code>  Apply complete! Resources: 5 added, 0 changed, 0 destroyed.

  Outputs:

  cluster_name = &quot;sandbox-cluster&quot;
  dns_zone_name_servers = tolist([
    &quot;ns-cloud-c1.googledomains.com.&quot;,
    &quot;ns-cloud-c2.googledomains.com.&quot;,
    &quot;ns-cloud-c3.googledomains.com.&quot;,
    &quot;ns-cloud-c4.googledomains.com.&quot;,
  ])
  domain = &quot;hello.vanille-fraise.net&quot;
  region = &quot;europe-west4&quot;
</code></pre></div>
<h2 id="verification-du-deploiement">Vérification du déploiement</h2>
<h3 id="dns">DNS</h3>
<p>Via la console :</p>
<div class="language-text highlight"><pre><span></span><code>  https://console.cloud.google.com/net-services/dns/zones/${APPLICATION_NAME}/details?organizationId=0&amp;project=${PROJECT_ID}
</code></pre></div>
<h3 id="cluster-kubernetes">Cluster Kubernetes</h3>
<p>Via la console :</p>
<div class="language-text highlight"><pre><span></span><code>  https://console.cloud.google.com/kubernetes/list/overview?organizationId=0&amp;project=${PROJECT_ID}
</code></pre></div>
<h3 id="ip-statique-publique">IP statique publique</h3>
<p>Via la console :</p>
<div class="language-text highlight"><pre><span></span><code>  https://console.cloud.google.com/networking/addresses/list?organizationId=0&amp;project=${PROJECT_ID}
</code></pre></div>
<h2 id="modification-des-name-servers-ns-du-domaine-dns-aupres-du-registrar">Modification des 'Name Servers (NS) du domaine DNS auprès du 'registrar'</h2>
<p>Même si vous avez réservé votre nom de domaine chez le 'registrar' <em>Google Domains</em>, vous devez modifier directement auprès de votre 'registrar' les serveurs de noms (NS) de votre zone et les remplacer par ceux listés en sortie du 'terraform apply'.
Dans notre exemple :</p>
<div class="language-text highlight"><pre><span></span><code>  ns-cloud-c1.googledomains.com
  ns-cloud-c2.googledomains.com
  ns-cloud-c3.googledomains.com
  ns-cloud-c4.googledomains.com
</code></pre></div>
<p>Dans mon cas, j'ai réservé mon nom de domaine auprès du registrar <em>Google Domains</em> :</p>
<div class="language-text highlight"><pre><span></span><code>  https://domains.google.com/registrar/${RESERVED_DOMAIN_NAME}/dns 
      -&gt; cliquer sur &#39;Serveurs de noms personnalisés&#39;
      -&gt; puis cliquer sur &#39;Gérer les serveurs de noms&#39;
      -&gt; Renseigner les serveurs de noms issus de la sortir de la commande &#39;terraform apply&#39; (dns_zone_name_servers)
</code></pre></div>
<p>Vérifier la résolution de noms :</p>
<div class="language-text highlight"><pre><span></span><code>  dig ${APPLICATION_NAME}.${RESERVED_DOMAIN_NAME}
      ;; ANSWER SECTION:
      hello.vanille-fraise.net. 300 IN  A       34.36.92.137

  dig www.${APPLICATION_NAME}.${RESERVED_DOMAIN_NAME}
      ;; ANSWER SECTION:
      www.hello.vanille-fraise.net. 300 IN CNAME hello.vanille-fraise.net.
      hello.vanille-fraise.net. 300 IN  A       34.36.92.137
</code></pre></div>
<p>Vérifier également dans CloudDNS dans la zone '${APPLICATION_NAME}' les entrées de type NS et SOA et s'assurer qu'elles correspondent bien aux serveurs de noms attendus :</p>
<div class="language-text highlight"><pre><span></span><code>    https://console.cloud.google.com/net-services/dns/zones/${APPLICATION_NAME}/details?organizationId=0&amp;project=${PROJECT_ID}
</code></pre></div>
<h2 id="deploiement-du-load-balancer-applicatif-externe">Déploiement du Load-Balancer applicatif externe</h2>
<p>( ManagedCertificate, FrontendConfig, Deployment, Service et Ingress)</p>
<h3 id="configuration-de-kubectl-pour-se-connecter-au-cluster-recemment-cree">Configuration de kubectl pour se connecter au cluster récemment créé</h3>
<div class="language-text highlight"><pre><span></span><code>  gcloud container clusters get-credentials ${CLUSTER_NAME} --region ${REGION} --project=${PROJECT_ID}
  -&gt; génère le fichier de configuration de kubectl : ~/.kube/config
</code></pre></div>
<h4 id="verifier-que-nous-utilisons-le-bon-contexte-kubernetes">Vérifier que nous utilisons le bon contexte kubernetes :</h4>
<div class="language-text highlight"><pre><span></span><code>  kubectl config view | grep current-context 
  -&gt; current-context: gke_${PROJECT_ID}_${REGION}_${CLUSTER_NAME}
</code></pre></div>
<h4 id="verifier-que-nous-pouvons-bien-nous-connecter-au-cluster">Vérifier que nous pouvons bien nous connecter au cluster</h4>
<div class="language-text highlight"><pre><span></span><code>  kubectl get pods -A 
  -&gt; retourne la liste de tous les pods du cluster
</code></pre></div>
<h3 id="creation-du-certificat-ssl-du-load-balancer-de-lingress">Création du certificat SSL, du load-balancer, de l'ingress</h3>
<div class="language-text highlight"><pre><span></span><code>  kubectl apply -f kubernetes-manifests.yaml
  ( note : la validation du certificat TLS prend 30 minutes environ )
</code></pre></div>
<h4 id="verification-de-la-creation-de-lingress">Vérification de la création de l'ingress</h4>
<div class="language-text highlight"><pre><span></span><code>  kubectl describe ingress frontend
</code></pre></div>
<h4 id="verification-du-provisioning-du-certificat-tls-peut-prendre-30-minutes">Vérification du provisioning du certificat TLS (peut prendre 30 minutes)</h4>
<h5 id="avec-kubectl">avec kubectl</h5>
<div class="language-text highlight"><pre><span></span><code>  kubectl get      managedcertificates.networking.gke.io frontend-managed-cert
  kubectl describe managedcertificates.networking.gke.io frontend-managed-cert
</code></pre></div>
<h5 id="via-la-console-security-certificate-manager">via la console : Security / Certificate Manager</h5>
<div class="language-text highlight"><pre><span></span><code>  https://console.cloud.google.com/apis/library/certificatemanager.googleapis.com?project=${PROJECT_ID}
  -&gt; activer Secret Manager API
  -&gt; cliquer sur &#39;CLASSIC CERTIFICATES&#39; -&gt; on voit le certificat en status : provisioning

  ( note : activer l&#39;API &#39;Certificate Manager&#39; pour accéder au certificat )
</code></pre></div>
<h5 id="documentation-de-troubleshooting-google-managed-ssl-certificates">Documentation de troubleshooting Google-managed SSL certificates :</h5>
<div class="language-text highlight"><pre><span></span><code>  https://cloud.google.com/load-balancing/docs/ssl-certificates/troubleshooting?hl=en
  https://cloud.google.com/load-balancing/docs/ssl-certificates/google-managed-certs?hl=en#caa
  https://cloud.google.com/kubernetes-engine/docs/how-to/managed-certs?hl=en
</code></pre></div>
<h4 id="verification-de-ladresse-ip-publique-reservee">Vérification de l'adresse IP publique réservée</h4>
<div class="language-text highlight"><pre><span></span><code>  gcloud compute addresses describe ${APPLICATION_NAME} --global
</code></pre></div>
<h4 id="verification-de-lingress">Vérification de l'Ingress</h4>
<div class="language-text highlight"><pre><span></span><code>  k get ingress

  NAME       CLASS    HOSTS   ADDRESS          PORTS   AGE
  frontend   &lt;none&gt;   *       34.117.157.187   80      5m41s
</code></pre></div>
<p>L'IP du load-balancer est ici <strong>34.117.157.187</strong>.</p>
<h2 id="test-application">Test application</h2>
<div class="language-text highlight"><pre><span></span><code>  curl -Lv https://${APPLICATION_NAME}.${RESERVED_DOMAIN_NAME}
  curl -Lv https://www.${APPLICATION_NAME}.${RESERVED_DOMAIN_NAME}
</code></pre></div>
<p>En accédant plusieurs fois à l'URL, on constate que le 'hostname' (ie. le pod) change. </p>
<h2 id="nettoyage">Nettoyage</h2>
<div class="language-text highlight"><pre><span></span><code>  gcloud projects delete ${PROJECT_ID} --quiet
  gcloud projects list
</code></pre></div>
<p>ou :</p>
<div class="language-text highlight"><pre><span></span><code>kubectl delete -f kubernetes-manifests.yaml
terraform destroy --auto-approve
</code></pre></div>
<h2 id="divers">Divers</h2>
<p>https://registry.terraform.io/providers/hashicorp/google/latest/docs/guides/using_gke_with_terraform</p>
<p>Debug Cloud DNS :</p>
<div class="language-text highlight"><pre><span></span><code>  gcloud dns managed-zones describe ${APPLICATION_NAME}
  gcloud dns record-sets list --zone ${APPLICATION_NAME}
  gcloud dns record-sets list --zone=${APPLICATION_NAME} --name ${APPLICATION_NAME}.${RESERVED_DOMAIN_NAME}
</code></pre></div>
<h2 id="next-step">Next step</h2>
<p>https://kubernetes.io/docs/tutorials/stateful-application/mysql-wordpress-persistent-volume/</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  </body>
</html>